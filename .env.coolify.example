# =====================================================================
# Variables d'environnement pour Coolify - MyTechGear Medusa
# =====================================================================
# Copier ce fichier dans Coolify → Settings → Environment Variables
# Remplacer les valeurs <placeholder> par les vraies valeurs
# =====================================================================

# ==================================================
# 1. BASE DE DONNÉES POSTGRESQL (Coolify)
# ==================================================
# URL fournie par Coolify après création de la ressource PostgreSQL
# IMPORTANT: Utiliser le nom de service interne (qwk40goo4w4448o8cw4gww08)
# PAS l'IP publique (78.47.79.58)
DATABASE_URL=postgres://medusa:xhgcpIOO6ABnhTvAYqCPpUNVSHk8zCx1oUbwtcpwOEZ3xmeK6gDxRLrLKKw90jXU@qwk40goo4w4448o8cw4gww08:5432/medusa

# ==================================================
# 2. REDIS CACHE (Coolify)
# ==================================================
# URL fournie par Coolify après création de la ressource Redis
# Créer: Resources → + New Resource → Redis → Version 7
REDIS_URL=redis://mytechgear-medusa-redis:6379

# ==================================================
# 3. SÉCURITÉ - SECRETS JWT & COOKIES
# ==================================================
# Générer avec: openssl rand -base64 64 | tr -d '\n'
# IMPORTANT: Générer de nouveaux secrets pour chaque environnement
JWT_SECRET=<générer-avec-openssl-rand-base64-64>
COOKIE_SECRET=<générer-avec-openssl-rand-base64-64>

# ==================================================
# 4. CORS CONFIGURATION (Production)
# ==================================================
# URLs autorisées pour les requêtes cross-origin
# STORE_CORS: Frontend client (Next.js)
# ADMIN_CORS: Interface admin Medusa
# AUTH_CORS: Authentification admin
STORE_CORS=https://mytechgear.eu,https://www.mytechgear.eu
ADMIN_CORS=https://admin.mytechgear.eu
AUTH_CORS=https://admin.mytechgear.eu

# ==================================================
# 5. STRIPE PAYMENT PROVIDER
# ==================================================
# Obtenir sur: https://dashboard.stripe.com/apikeys
# sk_live_... pour production, sk_test_... pour test
# Webhook URL: https://votre-domaine.com/hooks/stripe
# Événements: payment_intent.succeeded, payment_intent.payment_failed
STRIPE_SECRET_KEY=sk_live_VOTRE_CLE_STRIPE_ICI
STRIPE_WEBHOOK_SECRET=whsec_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ==================================================
# 6. BREVO EMAIL SERVICE (ex-Sendinblue)
# ==================================================
# Obtenir sur: https://app.brevo.com/settings/keys/api
# Gratuit jusqu'à 300 emails/jour
# L'email expéditeur doit être vérifié dans Brevo
BREVO_API_KEY=xkeysib-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
BREVO_SENDER_EMAIL=contact@mytechgear.eu
BREVO_SENDER_NAME=MyTechGear

# ==================================================
# 6b. S3 STORAGE — MinIO (Production Coolify)
# ==================================================
# Architecture: Instance MinIO unique sur Coolify
# Bootstrap CLI: voir infra/minio/Makefile et docs/MINIO_BOOTSTRAP.md
#
# Setup (depuis votre machine locale):
#   cd infra/minio
#   make minio-alias ALIAS=prod ENDPOINT=https://minio.mytechgear.eu \
#     MINIO_ROOT_USER=admin MINIO_ROOT_PASSWORD=<root-password>
#   make minio-bootstrap ALIAS=prod
#   make minio-keys ALIAS=prod
#
# Les clés générées (Service Account) vont ici:

# Endpoint S3 (réseau Docker interne Coolify)
S3_ENDPOINT=http://minio:9000

# Région S3 (convention MinIO)
S3_REGION=us-east-1

# Credentials S3 (Service Account généré via make minio-keys)
S3_ACCESS_KEY_ID=<access-key-depuis-minio-keys>
S3_SECRET_ACCESS_KEY=<secret-key-depuis-minio-keys>

# Nom du bucket
S3_BUCKET=mytechgear-assets

# URL publique des assets (CDN ou reverse proxy)
# ex: https://s3.assets.mytechgear.eu (recommandé avec CDN)
# ex: https://minio.mytechgear.eu/mytechgear-assets (sans CDN)
FILE_URL=https://s3.assets.mytechgear.eu

# ==================================================
# 7. MEDUSA ADMIN CONFIGURATION
# ==================================================
MEDUSA_ADMIN_ONBOARDING_TYPE=default
MEDUSA_ADMIN_ONBOARDING_NEXTJS=false

# Désactiver l'Admin UI Medusa (mode API-only)
# OBLIGATOIRE si vous utilisez un dashboard custom Next.js
# Sans cette var, l'Admin UI est servie sur /app (exposition non souhaitée)
DISABLE_MEDUSA_ADMIN=true

# Endpoint /_diagnostics (désactivé par défaut en prod)
# Activer uniquement pour debug ponctuel, remettre false ensuite
DIAGNOSTICS_ENABLED=false
# Clé d'accès /_diagnostics — générer : node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
DEBUG_KEY=<générer-une-clé-aléatoire-32-bytes-hex>

# ==================================================
# 8. SYSTÈME
# ==================================================
NODE_ENV=production

# ==================================================
# OPTIONNEL
# ==================================================
# DB_NAME=medusa
# PORT=9000 (géré automatiquement par Coolify)
